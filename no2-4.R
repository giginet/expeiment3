Torgerson<-function(s){
  if(nrow(s) != ncol(s)) return(0)
  m = nrow(s)
  b<-matrix(0, nrow(s), ncol(s))
  for(i in 1:m){
    for(j in 1:m){
      b[i, j]<-YoungHouseholder(s, i, j)
    }
  }
  e<-eigen(b)
  t<-matrix(c(e$vector), nrow(s), 2)
  a<-matrix(0, 2, 2)
  lambda<-e$values
  for(i in 1:2){
    a[i, i]<-sqrt(lambda[i])
  }
  x = t %*% a
  return(x)
}
YoungHouseholder<-function(s, i, j){
  m = nrow(s)
  si2<-mean(s[i,]**2)
  sj2<-mean(s[,j]**2)
  s2<-mean(s ** 2)
  return((-1/2)*(s[i, j] ** 2 - si2 - sj2 + s2))
}
s<-matrix(c(0.0, 3.0, 5.5, 5.0, 
            3.0, 0.0, 2.0, 4.5, 
            5.5, 2.0, 0.0, 1.0, 
            5.0, 4.5, 1.0, 0.0)
, 4, 4)
s2<-matrix(c(0.0, 8.89, 10.16, 15.84, 16.84, 33.01, 32.69, 43.47, 37.78, 39.31,
             8.89, 0.00, 9.64, 15.37, 20.45, 30.75, 34.09, 41.61, 39.26, 41.47,
             10.16, 9.64, 0.00, 6.12, 11.20, 22.98, 24.56, 33.61, 29.75, 31.86,
             15.84, 15.37, 6.12, 0.00, 8.48, 17.20, 18.75, 27.64, 23.91, 26.23,
             16.84, 20.45, 11.20, 8.48, 0.00, 20.77, 16.25, 29.52, 21.17, 22.49,
             33.01, 30.75, 22.98, 17.20, 20.77, 0.00, 13.01, 10.86, 15.61, 19.06,
             32.69, 34.09, 24.56, 18.75, 16.25, 13.01, 0.00, 15.99, 5.19, 7.69,
             43.47, 41.61, 33.61, 27.64, 29.52, 10.86, 15.99, 0.00, 14.84, 17.68,
             37.78, 39.26, 29.75, 23.91, 21.17, 15.61, 5.19, 14.84, 0.00, 3.45,
             39.31, 41.47, 31.86, 26.23, 22.49, 19.06, 7.69, 17.68, 3.45, 0.00)
, 10, 10)
print(result<-Torgerson(s))
print(result<-Torgerson(s2))
